\input{../../header}
\addbibresource{transport.bib}

\begin{document}

\pagenumbering{gobble}
\tableofcontents

\clearpage
\pagenumbering{roman}
\tocentry{Glossary}
\printglossary

\clearpage
\pagenumbering{arabic}
\section{Deterministic Algorithms for High Accuracy Coupled Photon-Electron-Positron Transport in Radiation Therapy Planning}
~\cite{bienvenue_deterministic_2024}

This dissertation focuses on purely charged particle transport, specifically deterministic algorithms to solve the \gls{bfp}. Of particular interest are Chapters 1 (background on coupled particle transport) and 2 (coupled photon, electron, and positron mgxs)


The \gls{sn} method is one of the more popular angular discretization techinques, particularly in nuclear engineering for neutron transport. There are serious limitation to this method however, when applied to highly forward-peaked scattering\ldots which is a dominant characteristic of charged particle transport. Only the time-independent \gls{bte} is used in this dissertation.

\subsection{Boltzmann Transport Equation}
The time-independent \gls{bte} is:

\begin{subequations}
    \begin{equation}
        \solidangle\cdot\nabla\angularflux^p\phasespace
        + \macroxs{t}^{p}\phasespace\angularflux^p\phasespace
        =
        Q_b^p\phasespace
        + Q_{ext}^p\phasespace
    \end{equation}
    \begin{equation}
        Q_b^p\phasespace
        =
        \sum_{p'\in P}\int_{4\pi} d\solidangle'\int_0^{\infty}d\energy'\macroxs{s}^{p'\rightarrow p}\phasespace\angularflux^{p'}\phasespace
    \end{equation}
    Where $p \in P := {\photon, \electron, \positron}$, and $\macroxs{}^{p'\rightarrow p}$ is the macroscopic double differential cross section of some particle $p'\incphasespace$ collisioning and producing particle $p\phasespace$.
\end{subequations}

\subsubsection{Angular and Energy Discretization}
It is common to ignore the angular dependence of the total cross section, and to approximate the angular dependence of the boltzmann operator ($Q_b^p$) using spherical harmonic moments:

\begin{subequations}
    \begin{equation}
        \solidangle\cdot\nabla\angularflux^p\phasespace
        + \macroxs{t}^{p}\lessophasespace\angularflux^p\phasespace
        =
        Q_b^p\phasespace
        + Q_{ext}^p\phasespace
    \end{equation}
    \begin{equation}
        Q_b^p\phasespace
        =
        \sum_{p'\in P}\int_0^{\infty}d\energy'\sum_q^{N_q}\macroxs{s, \ell_q}^{p'\rightarrow p}\lessophasespace \realsph{q}(\solidangle)\scalarflux^p_{q}\lessophasespace
    \end{equation}
    \begin{equation}
        \scalarflux^p{ q}\lessophasespace
        =
        \int_{4\pi}d\solidangle\realsph{q}(\solidangle)\angularflux^p\phasespace
    \end{equation}
\end{subequations}

Then, applying the standard energy discretization:

\begin{subequations}
    \begin{equation}
        \solidangle\cdot\nabla\angularflux^p{g}\lessephasespace
        + \macroxs{t,g}^{p}(\position)\angularflux^p{g}\lessephasespace
        =
        Q_b^{p,g}\lessephasespace
        + Q_{ext}^{p,g}\lessephasespace
    \end{equation}
    \begin{equation}
        \macroxs{t,g}^p(\position)
        =
        \frac{1}{\Delta\energy_g}\int_{\energy_{g+1/2}}^{\energy_{g-1/2}}d\energy\macroxs{t}^p\lessophasespace
    \end{equation}
    \begin{equation}
        \macroxs{s, \ell, g'\rightarrow g}^{p'\rightarrow p}(\position)
        =
        \frac{1}{\Delta_g}\int_{\energy_{g+1/2}}^{\energy_{g-1/2}}d\energy\macroxs{s, \ell, g'\rightarrow g}^{p'\rightarrow p}\lessophasespace
    \end{equation}
    \begin{equation}
        \macroxs{s, \ell, g'\rightarrow g}^{p'\rightarrow p}\lessophasespace
        =
        2\pi\int_{\energy'_{g+1/2}}^{\energy'_{g-1/2}}d\energy'
        \int_{-1}^1\legendre{\ell}(\mu)\macroxs{s}^{p'\rightarrow p}(\position, \energy'\rightarrow\energy,\mu)
    \end{equation}
\end{subequations}

\subsection{Fokker-Planck Equation}
The standard \gls{bte} is well suited for neutron transport, but is not for charged particles due to: Highly forward peaked scattering, scattering with atomic electrons, and small energy loss per scatter event (need a TON of energy groups to accurately capture slowing down). Assuming forward peaked scattering and small energy-loss processes, the fokker-planck variation of the \gls{bte} is derived. Look elsewhere for general derivation(~\cite{pomraning_higher_1996, beling_generalized_2023}) and high accuracy(~\cite{morel_fokker-planck_1981, uilkema_proton_2012}).

The main idea of the Fokker-Planck Approximation is that the boltzmann operator (which  is integrable in angle) can be converted into the Fokker-Planck operator (differentiable in Angle / energy). Further, the Fokker-Planck operator can be linearly seperated into the Continuous Slowing Down operator, the Angular Fokker-Planck operator, and the Energy Straggling Operator (not shown here):

\begin{subequations}
    \begin{equation}
        Q^p_{CSD}\phasespace = \pd{}{\energy}{}
        \left[
            S^p\lessophasespace\angularflux^p\phasespace
        \right]
    \end{equation}
    \begin{equation}
        Q^p_{AFP}\phasespace = T^p\lessophasespace
        \left[
            \pd{}{\mu}{}(1-\mu^2)\pd{}{\mu}{} + \frac{1}{1-\mu^2}\pd{}{\varphi}{2}
        \right]
        \angularflux^p\phasespace
    \end{equation}
    Where $S^p$ and $T^p$ are the stopping power and momentum transfer, respectively.
\end{subequations}

Limitations of this form of the boltzmann equation are that electrons and positrons often change direction when interacting, and these large angular changes also have large energy transfers -> going against the founding approximation of the Fokker-Planck equation.

\subsection{Boltzmann Fokker-Planck Equation}
The \gls{bfp} takes the Fokker-Plank equation, and seperate the scattering events into soft and catastrophic (small vs large angle/energy change).The catastrophic interactions are treated with the boltzmann operator, and the the soft are treated with the Fokker-Planck operator. This is a generalized form for the Boltzmann and Focker-Planck equations, allowing accurate results for general particle types (although potentially inneficient). It is important to note that the forms of each operator are the same, BUT the definitions for the macroscopic cross sections are completely different. 

\subsection{Angular Discretization Techniques}
\gls{sn}, \gls{pn}, and \gls{dgfem}.\ \gls{sn} is well suited for highly anisotropic scattering, but exhibits ray effects, \gls{sn} removes the ray effects, but is subject to ringing from expansion, and \gls{dgfem} removes all innacuracies but is painfully slow.\ \gls{sn} is the most performant, allowing for (trivial) angular and (non-trivial) spatial parallelization. 

Cannot apply traditional first collision source method (which breaks the flux into two regimes, collided and uncollided, solving uncollided with low order \gls{sn}, and then using it as a source for collided using a full \gls{sn} solve) because ray tracing must be done in space AND energy for the \gls{bfp}. Electrons do not need ray mitigation strategies because they scatter (a lot), but photons do need mitigation.

\subsection{Particle Coupling and Solving}
Coupling of particles is done by solving each particle individually, and then using the solution as a part of the source term for the next particle type to be solved. This iterative approach is solved until either some convergence criteria is met or some maximum number of 'generations' is conducted.

For each \gls{bfp}, the charged particles $\{\photon, \electron, \positron\}$ are assumed (?) to not have any upscattering events. Thus, the multigroup transport equation is solved by sweeping from the highest energy group to the lowest, where each group is solved via \gls{si}. The angular flux is solved along each direction ($\solidangle_n$) via a directional sweep, similair to \gls{kba} style sweeps.

\subsubsection{Convergence}
The speed of convergence is governed by the spectral radius:
\begin{equation}
    \rho = \lim_{\ell\rightarrow\infty}
    \frac{
        \norm{\angularflux^{\ell} - \angularflux^{\ell-1}}
    }
    {
        \norm{\angularflux^{\ell-1} - \angularflux^{\ell-2}}
    }
\end{equation}

where $\ell$ is iteration number. Spectral radius of much less than 1 is fast convergence, near one is slow, and greater than or equal to 1 does not converge. Doing a Fourier analysis on the spectral radius shows the radius is given by the ratio of elastic scattering to total cross section, and thus for problems with high elastic scattering dominance, slow convergence occurs~\cite{larsen_advances_2010}. Unfortunately, $\electron$ and $\positron$ interactions are dominaed by elastic scattering, and so convergence for these particles can be extremely slow. Bienvenue identifies the most relevant acceleration method for specifically $\electron$ and $\positron$ transport to be the transport correction. 

\paragraph{Transport Correction}
This correction essentially moves much of the responsibility for the inelastic scattering kernel from the boltzmann operator to the Fokker-Planck operator. This is done because the Boltzmann operator is where the spectral radius limitation comes from, so as much of the inelastic scattering should be offloaded to the Fokker-Planck operator as can feasibly be done (without impacting the final result).

\subsubsection{Acceleration}
To reduce the number of iterations for highly forward peaked scattering problems, Bienvenue cites the diffusion synthetic acceleration (commonly used in neutral particle transport) is ineffective. A potentially promising acceleration method was developed for 1-D geometries, but may not work for multi-D~\cite{morel_angular_1991}. Bienvenue, for his dissertation, used Livolant acceleration, which is based on residual minimization, but directly calls out Kyrlov subspace methods (namely \gls{gmres} and \gls{gmresm}) as a potentially better acceleration method. 

\gls{sn} is trivially parallelizable in angle, as each ordinate is independent, but can be a little trickier in space. If using a structure mesh however, \gls{kba} style sweeps are provably the fastest but is not trivial to implement.

\subsection{Novel scheme for angular discretization of \gls{afp}}
Novel scheme is based on Voronoi tessellation of unit sphere, and works with nonorthogonal quadrature sets. Also, is a monotone and moment preserving finite different scheme! Performs better than typical galerken scheme, and produces positive physical results! Very interesting, need to revisit!

Includes a Gram-Schmidt orthogonalization algorithm for choosing suitable spherical harmonic moments.

\clearpage
\section{Advances in Discrete Ordinates Methodology}
~\cite{larsen_advances_2010}
This paper reviews the major advancements in \gls{sn} methodology that have been made since 1968. The purpose of this chapter is to present the major advancements, but also the new algorithms developed for \gls{sn} that have greatly enabled the advances. 

Major concepts discussed are the original \gls{sn} method techniques published in 1968 (multigroup, \gls{sn} in angle, finite difference in space), \gls{sn} applications to advanced problems (charged particle transport), advanced spatial discretizations (MOC, DFEM, nodal), treatments of anisotropic scattering, curvilinear geometry (curved MOC rays? for magnetic fields), angular and energy discretizations for specifically charged particles, and advanced time discretizations. 

Further, for algorithmic advancements (acceleration), \gls{dsa}, source-iteration for time dependent calculations, and upscatter acceleration. Also, the application of preconditioned Krylov methods to \gls{sn}. 

Finally, the chapter ends with a discussion on (and identification of) future challenges facing \gls{sn}.

\subsection{Basic concepts behind \gls{sn}}
In order to describe coupled transport ($n, \gamma, \electron, \positron,\ldots$), a full system of coupled transport equations is required. A major problem for discretizations of the \gls{bte} is that while the equation itself provably has real, positive, solutions, the discretization scheme employed may not gaurantee this. 

\subsubsection{Differential Scattering Cross Section}
The differential scattering cross section, $\macroxs{s}\left(\position, \solidangle'\cdot\solidangle, \energy'\rightarrow\energy\right)$ is commonly written as an legendre expansion:

\begin{equation}
    \label{eq:sigmas_expansion}
    \macroxs{s}\left(\position, \solidangle'\cdot\solidangle,\energy'\rightarrow\energy\right) = 
    \sum_{m=0}^{\infty}\frac{2m + 1}{4\pi}P_m(\solidangle'\cdot\solidangle)\macroxs{s,m}\left(\position,\energy'\rightarrow\energy\right)
\end{equation}

\subsubsection{Time discretization}
Most common method in 1968 (and today) is implicit euler, basically integrate from $t_{i-1/2} \rightarrow t_{i+1/2}$, then divide by $\Delta t = t_{i+1/2} - t_{i-1/2}$. Implicit Euler yields steady state equations to be solved at each timestep, and the ssolution of time step $i$ is used as the source on the rhs of time step $i+1$. Because the steady state solution with a positive source (ignoring truncation error from $\frac{\partial}{\partial t}$ approximation) is gauranteed positive, which is an ideal pro of this method. However, Implicit Euler is only first order accurate, and so truncation error can be very large given large timesteps. Because temporal discretizations break time dependence into a bunch of steady state problems that then get woven back together, the methods for solving the \gls{bte} are pretty much the same after temporal discretization. 

\subsubsection{Energy discretization}
Standarad multigroup, same as diffusion. Because left hand side of \gls{bte} is independent of other groups, the multigroup approximation forms a system of equations coupled only by the scattering and fission terms. The multigroup approximation is also inherently positive, gaurantee positive flux (again ignoring truncation).

\subsubsection{Angular discretization}
\gls{sn} works by breaking the angular domain into discrete bins called `ordinates', with some fractional area (or width) over whole angular domain. These bins are then prescribed expansion weights found from integrating the legendre expansion over the ordinate area (width). A little confused about after ordinate discretization, how to solve (just need clarification)? 

Selection of quadrature set (how to break up angle into bins) is extremely important. For most 1-D problems, the even-order Gauss-Legendre quadrature sets are ideal, more complicated for multi-D. 

\subsubsection{Spatial discretization}
Break domain into cells, with unknowns being cell edge and cell average fluxs. This results in more unknowns than equations, and so diamon differencing has been employed. Diamond differencing yields positive fluxs iff cell size is sufficiently small, otherwise negative results can be reported. 

\subsubsection{Solution methods}
After discretization of all variables, the system can be expressed as $A\angularflux=q$, where q is the source vector, and $A$ is a matrix. This can be solved by direct inversion, however $A$ is usually prohibitively large such that direct inversion is intractable. Thus, alternative methods to approximate the solution must be used. These methods are iterative methods. 

\paragraph{Source Iteration}
The most common is source-iteration, which assumes the right hand side (the fission and scattering source terms) are known for each individual equation (node, time, group, ordinate), and then explicitly solves for the angular flux that way. The source term (scattering and fission) is then iteratively updated. Source iteration begins by applying an estimate to the scattering source term, typically zero. Using the estimated scattering source, the space and angle equations are solved by a transport sweep. The angular flux results from this sweep are then used in the scattering source term for the next iteration, and this is repeated until convergence. Source iteration is valid for scattering media, as without scattering the source iteration makes no sense (the `source' is updated in scattering term). If the scattering media is optically thin (few scatter interactions) the source iteration scheme will converge rapidly. If the scattering media is optically thick with \textbf{weak absorption}, then the source iteration scheme will converge slowly. The source iteration convergence is directly correlated to how many collision histories a given particle will generate in the problem media, and so when there are more collision histories, source iteration will need a bunch of histories to approximate real behavior. 

For multigroup with no upscattering, the source iteration scheme is iterated beginning with g=1 until convergence, and then this flows down (solving each consequent g). For multigroup with upscattering, the problem is solved by approximating the upscattering source term in each group as zero, and then iteratively solving as if there is no upscattering. Then, the resulting group angular fluxs are then used to update the upscattering source term in each group, and then the problem is repeated, assuming that the upscattering source in each group is unchanged. This then results in new angular fluxes, which are then used to update the upscattering source term, and the problem is then solved again assuming upscattering source terms are not changing. This process is done until convergence, or until a user specified maximum number of iterations. This process is called `outer iteration', and will converge rapidly iff the upscattering probability is small. If upscattering probability is high, this will converge slowly. 

The accuracy of this method can be measured via the spectral radius, which is essentially the relative difference between iterations:

\begin{equation}
    \rho = \lim_{i\rightarrow\infty}\frac{\norm{\angularflux^i - \angularflux^{i-1}}}{\norm{\angularflux^{i-1} - \angularflux^{i-2}}}
\end{equation}

The smaller $\rho$, the faster convergence (as the relative difference is closer to 0). Fourier analysis on one group transport in infinite homogenous medium has:

\begin{equation}
    \rho = \frac{\Sigma_s}{\Sigma_t}
\end{equation}

Source iteration is gauranteed to converge, but for many important problems it converges slowly. 

\subsection{Charged Particle Transport}

\clearpage
\tocentry{References}
\section*{References}
\printbibliography[heading=none]

\end{document}